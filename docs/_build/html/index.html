
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Welcome to MASK Framework’s documentation! &#8212; MASK Framework  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="welcome-to-mask-framework-s-documentation">
<h1>Welcome to MASK Framework’s documentation!<a class="headerlink" href="#welcome-to-mask-framework-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="intorduction">
<h1>Intorduction<a class="headerlink" href="#intorduction" title="Permalink to this headline">¶</a></h1>
<p><strong>MASK Framework is an open-source framework for de-identification of medical free-text data</strong></p>
<p>In this project, we will develop an open-source framework for automated de-identification of medical textual data. Such data contains information that can be utilized to support clinical research, but its native form contains sensitive personal identifiable information (PII) that should not be accessed by anyone who does not provide direct clinical care.</p>
<p>The project aims to enhance the current processes and build an open-source platform that can be used for flexible masking of personal information, ensuring that de-identified medical text still contains enough information to facilitate research.</p>
<p>In order to facilitate flexibility, the de-identification system has to be configurable by the user in terms of:</p>
<ul class="simple">
<li><p>Types of PII that have to be identified in free-text data;</p></li>
<li><p>Approaches to masking of the identified data (keep, redact, map, etc.);</p></li>
<li><p>Disclosure risk analysis that is performed on the data;</p></li>
<li><p>The methodology that is applied for each of the steps.</p></li>
</ul>
</div>
<div class="section" id="architectural-considerations">
<h1>Architectural considerations<a class="headerlink" href="#architectural-considerations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>The requirements for the configuration file are:</p>
<ul class="simple">
<li><p>Store the information about algorithms that should be used for NER</p></li>
<li><p>This can be done for per entity</p></li>
<li><dl class="simple">
<dt>Store information about masking</dt><dd><ul>
<li><p>Which named entities to mask</p></li>
<li><p>How these named entities should be masked</p></li>
<li><p>There can be a choice: do not mask, map and redact</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Talk to ICES what should we implement as examples (name, postcode, age intervals)</p></li>
<li><p>User can pick algorithm for mapping</p></li>
<li><p>Algorithms for mapping can be added as plugins</p></li>
<li><p>Mapping algorithms should be defined for each NER</p></li>
</ul>
</div>
<div class="section" id="architectural-consideration-for-extendable-framework-and-configuration">
<h2>Architectural consideration for extendable framework and configuration<a class="headerlink" href="#architectural-consideration-for-extendable-framework-and-configuration" title="Permalink to this headline">¶</a></h2>
<p>For named entity recognition algorithms there are following considerations:</p>
<ul class="simple">
<li><p>All implementations should be implemented in a single file as a class</p></li>
<li><p>All implementations should be stored in a single folder</p></li>
<li><p>All implementations should inherit same abstract class, implement method initialize (should load the models), perform_NER (takes string and returns an array of tuples with class, begin span, end span).</p></li>
<li><p>They should all return a subset of defined classes (PATIENT_NAME, DOCTOR_NAME, PROFESSION, ADDRESS, CITY, COUNTRY, POST_CODE, PHONE_NUMBER, EMAIL, WEB_ADDRESS, PATIENT_ID, DOCTOR_ID, ORGANIZATION, DATE)</p></li>
<li><p>Defined functions in the config file should correspond to the class and file names in this directory</p></li>
</ul>
<p>For extensions related to masking functions there are following considerations:</p>
<ul class="simple">
<li><p>All implementations should be implemented in a single file as a class</p></li>
<li><p>All implementations should be all stored in a single folder</p></li>
<li><p>All implementations should inherit the same abstract class and implement “mask” method that takes as input string to be masked and return masked string (either mapped or redacted in a particular manner).</p></li>
<li><p>Defined functions in the config file should correspond to the class and file names in this directory</p></li>
</ul>
</div>
<div class="section" id="configuration-file-example-and-explanation">
<h2>Configuration file example and explanation<a class="headerlink" href="#configuration-file-example-and-explanation" title="Permalink to this headline">¶</a></h2>
<p>Example of configuration file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">project</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">project_name</span><span class="o">&gt;</span><span class="n">Masking</span> <span class="n">v1</span><span class="o">&lt;/</span><span class="n">project_name</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">project_start_date</span><span class="o">&gt;</span><span class="mi">30</span><span class="o">/</span><span class="mi">05</span><span class="o">/</span><span class="mi">2019</span><span class="o">&lt;/</span><span class="n">project_start_date</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">project_owner</span><span class="o">&gt;</span><span class="n">Nikola</span> <span class="n">Milosevic</span><span class="o">&lt;/</span><span class="n">project_owner</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">project_owner_contact</span><span class="o">&gt;</span><span class="n">nikola</span><span class="o">.</span><span class="n">milosevic</span><span class="nd">@manchester</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">uk</span><span class="o">&lt;/</span><span class="n">project_owner_contact</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">algorithms</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">entity</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">entity_name</span><span class="o">&gt;</span><span class="n">NAME</span><span class="o">&lt;/</span><span class="n">entity_name</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">original_name</span><span class="o">&gt;</span><span class="n">NAME</span><span class="o">&lt;/</span><span class="n">original_name</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">algorithm</span><span class="o">&gt;</span><span class="n">NER_CRF</span><span class="o">&lt;/</span><span class="n">algorithm</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">masking_type</span><span class="o">&gt;</span><span class="n">Redact</span><span class="o">&lt;/</span><span class="n">masking_type</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">entity</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">entity</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">entity_name</span><span class="o">&gt;</span><span class="n">DATE</span><span class="o">&lt;/</span><span class="n">entity_name</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">original_name</span><span class="o">&gt;</span><span class="n">DATE</span><span class="o">&lt;/</span><span class="n">original_name</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">algorithm</span><span class="o">&gt;</span><span class="n">NER_CRF</span><span class="o">&lt;/</span><span class="n">algorithm</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">masking_type</span><span class="o">&gt;</span><span class="n">Mask</span><span class="o">&lt;/</span><span class="n">masking_type</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">masking_class</span><span class="o">&gt;</span><span class="n">Mask_date_simple</span><span class="o">&lt;/</span><span class="n">masking_class</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">entity</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">algorithms</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">dataset</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">dataset_location</span><span class="o">&gt;</span><span class="n">dataset</span><span class="o">/</span><span class="nb">input</span><span class="o">&lt;/</span><span class="n">dataset_location</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">data_output</span><span class="o">&gt;</span><span class="n">dataset</span><span class="o">/</span><span class="n">output</span><span class="o">&lt;/</span><span class="n">data_output</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">dataset</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">project</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="explanation">
<h2>Explanation<a class="headerlink" href="#explanation" title="Permalink to this headline">¶</a></h2>
<p>The whole configuration is wrapped in &lt;project&gt; tag. The user can name the project (using &lt;project_name&gt;), and give some basic information about creator and contact details. For each entity, user would like to mask, he/she needs to create &lt;entity&gt; tag.</p>
<p>Inside &lt;entity&gt; tag, user has to define entity name (using entity_name tag), he can specify original name that his named entity recognizer outputs (using original_name tag), specify NER algorithm for recognition (using &lt;algorithm&gt; tag) and define masking. Masking can be defined by specifying masking type (using masking_type tag). Possible values for masking type are:</p>
<ul class="simple">
<li><p>Nothing - does nothing, does not redact or mask entity, but leaves it in text.</p></li>
<li><p>Mask - masks entity with another string. The way of masking has to be defined with the masking_class tag.</p></li>
<li><p>Redact - redacts the entity (setting either XXX or entity name - to be discussed in the future).</p></li>
</ul>
</div>
</div>
<div class="section" id="dependancies">
<h1>Dependancies<a class="headerlink" href="#dependancies" title="Permalink to this headline">¶</a></h1>
<p>Dependances are defined in requirements.txt file and can be installed by running</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip3 install -r requirements.txt
</pre></div>
</div>
<p>List of all requirements:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sklearn_crfsuite</span><span class="o">==</span><span class="mf">0.3</span><span class="o">.</span><span class="mi">6</span>
<span class="n">nltk</span><span class="o">==</span><span class="mf">3.2</span><span class="o">.</span><span class="mi">5</span>
</pre></div>
</div>
</div>
<div class="section" id="module-mask_framework">
<span id="classes-and-functions"></span><h1>Classes and functions<a class="headerlink" href="#module-mask_framework" title="Permalink to this headline">¶</a></h1>
<p><em>mask_framework.py</em> – Main MASK Framework module</p>
<dl class="class">
<dt id="mask_framework.Configuration">
<em class="property">class </em><code class="sig-prename descclassname">mask_framework.</code><code class="sig-name descname">Configuration</code><span class="sig-paren">(</span><em class="sig-param">configuration='configuration.cnf'</em><span class="sig-paren">)</span><a class="headerlink" href="#mask_framework.Configuration" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for reading configuration file</p>
<p>Init function that can take configuration file, or it uses default location: configuration.cnf file in folder
where mask_framework is</p>
</dd></dl>

<dl class="function">
<dt id="mask_framework.main">
<code class="sig-prename descclassname">mask_framework.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mask_framework.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Main MASK Framework function</p>
</dd></dl>

<span class="target" id="module-ner_plugins"></span><p><em>ner_plugins</em> - a set of modules that can perform named entity recognition. Basically, plugins for different kinds of named entity recognition</p>
<span class="target" id="module-masking_plugins"></span><dl class="class">
<dt>
<em class="property">class </em><code class="sig-prename descclassname">mask_framework.</code><code class="sig-name descname">Configuration</code><span class="sig-paren">(</span><em class="sig-param">configuration='configuration.cnf'</em><span class="sig-paren">)</span></dt>
<dd><p>Class for reading configuration file</p>
<p>Init function that can take configuration file, or it uses default location: configuration.cnf file in folder
where mask_framework is</p>
</dd></dl>

<dl class="class">
<dt id="ner_plugins.NER_CRF.NER_CRF">
<em class="property">class </em><code class="sig-prename descclassname">ner_plugins.NER_CRF.</code><code class="sig-name descname">NER_CRF</code><a class="headerlink" href="#ner_plugins.NER_CRF.NER_CRF" title="Permalink to this definition">¶</a></dt>
<dd><p>The class for executing CRF labelling based on i2b2 dataset (2014).</p>
<dl class="method">
<dt id="ner_plugins.NER_CRF.NER_CRF.custom_span_tokenize">
<code class="sig-name descname">custom_span_tokenize</code><span class="sig-paren">(</span><em class="sig-param">text</em>, <em class="sig-param">language='english'</em>, <em class="sig-param">preserve_line=True</em><span class="sig-paren">)</span><a class="headerlink" href="#ner_plugins.NER_CRF.NER_CRF.custom_span_tokenize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a spans of tokens in text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> – text to split into words</p></li>
<li><p><strong>language</strong> (<em>str</em>) – the model name in the Punkt corpus</p></li>
<li><p><strong>preserve_line</strong> – An option to keep the preserve the sentence and not sentence tokenize it.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ner_plugins.NER_CRF.NER_CRF.custom_word_tokenize">
<code class="sig-name descname">custom_word_tokenize</code><span class="sig-paren">(</span><em class="sig-param">text</em>, <em class="sig-param">language='english'</em>, <em class="sig-param">preserve_line=True</em><span class="sig-paren">)</span><a class="headerlink" href="#ner_plugins.NER_CRF.NER_CRF.custom_word_tokenize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tokenized copy of <em>text</em>,
using NLTK’s recommended word tokenizer
(currently an improved <code class="xref py py-class docutils literal notranslate"><span class="pre">TreebankWordTokenizer</span></code>
along with <code class="xref py py-class docutils literal notranslate"><span class="pre">PunktSentenceTokenizer</span></code>
for the specified language).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> – text to split into words</p></li>
<li><p><strong>text</strong> – str</p></li>
<li><p><strong>language</strong> (<em>str</em>) – the model name in the Punkt corpus</p></li>
<li><p><strong>preserve_line</strong> – An option to keep the preserve the sentence and not sentence tokenize it.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ner_plugins.NER_CRF.NER_CRF.doc2features">
<code class="sig-name descname">doc2features</code><span class="sig-paren">(</span><em class="sig-param">sent</em><span class="sig-paren">)</span><a class="headerlink" href="#ner_plugins.NER_CRF.NER_CRF.doc2features" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a sentence to a sequence of features</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sent</strong> – a set of tokens that will be transformed to features</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ner_plugins.NER_CRF.NER_CRF.perform_NER">
<code class="sig-name descname">perform_NER</code><span class="sig-paren">(</span><em class="sig-param">text</em><span class="sig-paren">)</span><a class="headerlink" href="#ner_plugins.NER_CRF.NER_CRF.perform_NER" title="Permalink to this definition">¶</a></dt>
<dd><p>Implemented function that performs named entity recognition using CRF. Returns a sequence of tuples (token,label).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>text</strong> – text over which should be performed named entity recognition</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ner_plugins.NER_CRF.NER_CRF.tokenize_fa">
<code class="sig-name descname">tokenize_fa</code><span class="sig-paren">(</span><em class="sig-param">documents</em><span class="sig-paren">)</span><a class="headerlink" href="#ner_plugins.NER_CRF.NER_CRF.tokenize_fa" title="Permalink to this definition">¶</a></dt>
<dd><p>Tokenization function. Returns list of sequences</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>documents</strong> – list of texts</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ner_plugins.NER_CRF.NER_CRF.word2features">
<code class="sig-name descname">word2features</code><span class="sig-paren">(</span><em class="sig-param">sent</em>, <em class="sig-param">i</em><span class="sig-paren">)</span><a class="headerlink" href="#ner_plugins.NER_CRF.NER_CRF.word2features" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms words into features that are fed into CRF model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sent</strong> – a list of tokens in a single sentence</p></li>
<li><p><strong>i</strong> (<em>int</em>) – position of a transformed word in a given sentence (token sequence)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ner_plugins.NER_abstract.NER_abstract">
<em class="property">class </em><code class="sig-prename descclassname">ner_plugins.NER_abstract.</code><code class="sig-name descname">NER_abstract</code><a class="headerlink" href="#ner_plugins.NER_abstract.NER_abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract class that other NER plugins should implement</p>
<dl class="method">
<dt id="ner_plugins.NER_abstract.NER_abstract.perform_NER">
<code class="sig-name descname">perform_NER</code><span class="sig-paren">(</span><em class="sig-param">text</em><span class="sig-paren">)</span><a class="headerlink" href="#ner_plugins.NER_abstract.NER_abstract.perform_NER" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of the method that should perform named entity recognition</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="masking_plugins.Mask_abstract.Mask_abstract">
<em class="property">class </em><code class="sig-prename descclassname">masking_plugins.Mask_abstract.</code><code class="sig-name descname">Mask_abstract</code><a class="headerlink" href="#masking_plugins.Mask_abstract.Mask_abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract class that other masking plugins should implement</p>
<dl class="method">
<dt id="masking_plugins.Mask_abstract.Mask_abstract.mask">
<code class="sig-name descname">mask</code><span class="sig-paren">(</span><em class="sig-param">text_to_reduct</em>, <em class="sig-param">context=[]</em>, <em class="sig-param">document=[]</em>, <em class="sig-param">replacement_list={}</em><span class="sig-paren">)</span><a class="headerlink" href="#masking_plugins.Mask_abstract.Mask_abstract.mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of the method that should perform masking. Returns changed token</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text_to_reduct</strong> – a token that should be changed</p></li>
<li><p><strong>context</strong> – a context around the token that should be reducted. It is a list of tokens. Can be sentence or more. It is optional variable and does not need to be used</p></li>
<li><p><strong>document</strong> – a whole document as a list of tokens. Can be used as context. Optional variable and does not need to be used</p></li>
<li><p><strong>replacement_list</strong> – list of strings with their replacements. Can be used to search for tokens or part of it, in order to replace with the value of dictionary.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="masking_plugins.Mask_date_simple.Mask_date_simple">
<em class="property">class </em><code class="sig-prename descclassname">masking_plugins.Mask_date_simple.</code><code class="sig-name descname">Mask_date_simple</code><a class="headerlink" href="#masking_plugins.Mask_date_simple.Mask_date_simple" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract class that other masking plugins should implement</p>
<dl class="method">
<dt id="masking_plugins.Mask_date_simple.Mask_date_simple.mask">
<code class="sig-name descname">mask</code><span class="sig-paren">(</span><em class="sig-param">text</em><span class="sig-paren">)</span><a class="headerlink" href="#masking_plugins.Mask_date_simple.Mask_date_simple.mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of the method that should perform masking. Takes a token as input and returns a set string “DATE”</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">MASK Framework</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Nikola Milosevic.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>